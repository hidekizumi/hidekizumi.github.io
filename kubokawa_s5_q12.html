<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="担当 : 泉　英樹" />
  <title>現代数理統計学の基礎 〜第5章 問12〜</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">現代数理統計学の基礎<br />
〜第5章 問12〜</h1>
<p class="author">担当 : 泉　英樹</p>
<p class="date">2021年8月4日</p>
</header>

<h1 id="問題文">問題文</h1>
<p>問 12</p>
<p><span class="math inline">\(X_n \sim Bin(n,p)\)</span>として、次のように<span class="math inline">\(Y_n\)</span>を置く。 <span class="math display">\[Y_n = 
    \begin{cases}
        1 &amp; (X_n = 0)\\
        \log{ (\frac{X_n}{n}) } &amp; (X_n \geq 1)
    \end{cases}\]</span></p>
<p>このとき <span class="math inline">\(Y_n \rightarrow_p \log{p}\)</span>と、<span class="math inline">\(\sqrt{n}(Y_n − \log{p}) \rightarrow_d \mathcal{N} (0,\frac{1−p}{p})\)</span>を示せ。</p>
<h1 id="準備">準備</h1>
<h2 id="確率収束">確率収束</h2>
<p>確率変数の列<span class="math inline">\(\{U_n\}_{n=1, 2, \cdots}\)</span>が確率変数<span class="math inline">\(U\)</span>に確率収束するとは、任意の<span class="math inline">\(\varepsilon &gt; 0\)</span>に対して、 <span class="math display">\[\lim_{n \rightarrow \infty} P(|U_n−U| \geq \varepsilon) = 0\]</span></p>
<p>となることをいい、<span class="math inline">\(U_n \rightarrow_p U\)</span>で表す。</p>
<h2 id="分布収束">分布収束</h2>
<p>確率変数の列<span class="math inline">\(\{U_n\}_{n=1, 2, \cdots}\)</span>が確率変数<span class="math inline">\(U\)</span>に分布収束するとは、 <span class="math display">\[\lim_{n \rightarrow \infty} P(U_n \leq x) = P(U \leq x) = F_U(x)\]</span></p>
<p>が、<span class="math inline">\(F_U(x)\)</span>の連続点で成り立つことをいい、となることをいい、<span class="math inline">\(U_n \rightarrow_d U\)</span>で表す。</p>
<h2 id="確率収束と分布収束の関係">確率収束と分布収束の関係</h2>
<ul>
<li><p><span class="math inline">\(U_n \rightarrow_p U\)</span>ならば、<span class="math inline">\(U_n \rightarrow_d U\)</span></p></li>
<li><p><span class="math inline">\(a\)</span>を定数とすると、<span class="math inline">\(U_n \rightarrow_d a\)</span>ならば、<span class="math inline">\(U_n \rightarrow_p a\)</span></p></li>
</ul>
<h2 id="スラツキーの定理">スラツキーの定理</h2>
<p>確率変数の列<span class="math inline">\(\{U_n\}_{n=1, 2, \cdots}\)</span>、<span class="math inline">\(\{V_n\}_{n=1, 2, \cdots}\)</span>、確率変数<span class="math inline">\(U\)</span>、定数<span class="math inline">\(a\)</span>に対して、 <span class="math inline">\(U_n \rightarrow_d U\)</span>、<span class="math inline">\(V_n \rightarrow_p a\)</span>とする。このとき、次が成り立つ。</p>
<ul>
<li><p><span class="math inline">\(U_n + V_n \rightarrow_d U+a\)</span></p></li>
<li><p><span class="math inline">\(U_n \times V_n \rightarrow_d a \times U\)</span></p></li>
</ul>
<h2 id="中心極限定理">中心極限定理</h2>
<p><span class="math inline">\(X_1, X_2, \cdots, i.i.d. \sim (\mu, \sigma)\)</span> とする。この時、次の分布収束が成り立つ。 <span class="math display">\[\lim_{n \rightarrow \infty }P\left( \frac{ \sqrt{n} (X_{n}-\mu)}{ \sigma} \leq x \right) = \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{x} e^{-x^{2} / 2} d x\]</span></p>
<h1 id="回答">回答</h1>
<p>まず、<span class="math inline">\(Y_n \rightarrow_p \log{p}\)</span>、すなわち、十分小さい<span class="math inline">\(\varepsilon &gt; 0\)</span>に対して，<span class="math inline">\(n → \infty\)</span>のとき<span class="math inline">\(P(|Y_n−\log{p}| &gt; \varepsilon) → 0\)</span>が成り立つことを示す。 最初に、<span class="math inline">\(Y_n\)</span>の場合分けに基づき、 <span class="math display">\[P(|Y_n−\log{p}| &gt; \varepsilon) = P(|\log{\frac{X_n}{n}}−\log{p}| &gt; \varepsilon,X_n \geq 1)+P(|1−\log{p}| &gt; \varepsilon,X_n = 0) \tag{1}\]</span>と分割できる。</p>
<p>(1)式の第2項について、二項分布のパラメータ<span class="math inline">\(p\)</span>は対数の真数条件などから、本問では<span class="math inline">\(0 &lt; p \leq 1\)</span>であると考えられるため、 <span class="math inline">\(-\infty &lt; \log{p} \leq 0\)</span>であり、さらに<span class="math inline">\(\varepsilon\)</span>は十分小さいから、常に、 <span class="math inline">\(|1−\log{p}| &gt; 1 &gt; \varepsilon &gt; 0\)</span>と言える。 よって、(1)式の第2項は、<span class="math inline">\(0\leq1-p&lt;1\)</span>より、 <span class="math display">\[P(|1−\log{p}| &gt; \varepsilon,X_n = 0) = P(X_n = 0) = \binom{n}{0} p^0 (1−p)^{n-0} = (1-p)^n \xrightarrow[n\rightarrow \infty]{} 0\]</span>となる。</p>
<p>(1)式の第1項については、まず、<span class="math inline">\(\left|\log \frac{X_{n}}{n}-\log p\right| &gt; \varepsilon\)</span>の反対の区間である（言い方が変ですみません）、<span class="math inline">\(\left|\log \frac{X_{n}}{n}-\log p\right| \leq \varepsilon\)</span>について考える。</p>
<p><span class="math display">\[\begin{aligned}
        \left|\log \frac{X_{n}}{n}-\log p\right| \leq \varepsilon 
        &amp;\Longleftrightarrow \left|\log \frac{X_{n}}{np}\right| \leq \varepsilon  \\
        &amp;\Longleftrightarrow -\varepsilon \leq \log \frac{X_{n}}{n p} \leq \varepsilon \\
        &amp;\Longleftrightarrow e^{-\varepsilon} \leq \frac{X_{n}}{n p} \leq e^{\varepsilon} \\
        &amp;\Longleftrightarrow pe^{-\varepsilon} \leq \frac{X_{n}}{n} \leq pe^{\varepsilon} \\
        &amp;\Longleftrightarrow pe^{-\varepsilon} - p \leq \frac{X_{n}}{n} - p \leq pe^{\varepsilon} - p \\
        &amp;\Longleftrightarrow -p\left(1-e^{-\varepsilon}\right) \leq \frac{X_{n}}{n}-p \leq p\left(e^{\varepsilon}-1\right) \\
        &amp;\Longleftrightarrow \left|\frac{X_{n}}{n}-p \right| \leq  \min \left\{p\left(1-e^{-\varepsilon}\right), p\left(e^{\varepsilon}-1\right)\right\}
    \end{aligned}\]</span></p>
<p>従って，<span class="math inline">\(\delta=\min \left\{p\left(1-e^{-\varepsilon}\right), p\left(e^{\varepsilon}-1\right)\right\}\)</span> とおくと， <span class="math display">\[\left|\frac{X_{n}}{n}-p \right| \leq \delta \text{が満たされれば、}
    \left|\log \frac{X_{n}}{n}-\log p\right| \leq \varepsilon \text{が常に成り立つ。}\]</span></p>
<p>この対偶をとると、 <span class="math display">\[\left|\log \frac{X_{n}}{n}-\log p\right|&gt;\varepsilon \text{が満たされれば、}
    \left|\frac{X_{n}}{n}- p\right| &gt; \delta \text{が常に成り立つ。}\]</span></p>
<p>故に、(1)式の第1項は、 <span class="math display">\[\begin{aligned}
        P\left(\left|\log \frac{X_{n}}{n}-\log p\right|&gt;\varepsilon, X_{n} \geq 1\right) 
        &amp;= P\left(\left|\frac{X_{n}}{n}-p\right|&gt;\delta, X_{n} \geq 1\right) \\ 
        &amp;\leq P\left(\left|\frac{X_{n}}{n}-p\right|&gt;\delta\right) \text{　　(周辺確率は同時確率以上にはなるから)} \\
        &amp;\xrightarrow[n\rightarrow \infty]{} 0 \text{　　($X_n \sim Bin(n,p)$のとき、大数の弱法則より$\frac{X_{n}}{n}はp$ に確率収束するから)}
    \end{aligned}\]</span></p>
<p>従って、確率は常に0以上なので、はさみうち的に(1)式の第1項も0に収束する。</p>
<p>以上より、(1)式の第1項も第2項も<span class="math inline">\(n → \infty\)</span>のときに0に収束するので、 <span class="math inline">\(\lim_{n → \infty} P(|Y_n−\log{p}| &gt; \varepsilon) = 0\)</span>となり、 <span class="math inline">\(Y_n \rightarrow_p \log{p}\)</span>が成り立つ。</p>
<p><span class="math display">\[\\\]</span></p>
<p>次に、<span class="math inline">\(\sqrt{n}(Y_n − \log{p}) \rightarrow_d \mathcal{N} (0,\frac{1−p}{p})\)</span>が成り立つことを示す。</p>
<p>最初に、<span class="math inline">\(Y_n\)</span>の場合分けに基づき分割すると、 <span class="math display">\[\sqrt{n}\left(Y_{n}-\log p\right)=\sqrt{n}\left(\log \frac{X_{n}}{n}-\log p\right) I_{[X_{n} \geq 1]}+\sqrt{n}(1-\log p) I_{[X_{n}=0]} \tag{2}\]</span></p>
<p>ここで、確率収束するならば分布収束が成り立つから、(2)式の第2項の一部である<span class="math inline">\(I\left(X_{n}=0\right)\)</span>を確率収束の観点で考えてみる。 <span class="math inline">\(P\left( I_{[X_{n}=0]} &gt;\varepsilon\right)\)</span> とすると、定義関数の性質と<span class="math inline">\(\varepsilon &gt;0\)</span>より、 <span class="math display">\[P\left( I_{[X_{n}=0]} &gt;\varepsilon\right)=P\left(X_{n}=0\right) = \binom{n}{0} p^0 (1−p)^{n-0} = (1-p)^n \xrightarrow[n\rightarrow \infty]{} 0\]</span> よって、<span class="math inline">\(P\left( | I_{[X_{n}=0]} - 0| &gt;\varepsilon\right) \xrightarrow[n\rightarrow \infty]{} 0\)</span>が成り立つから、<span class="math inline">\(I_{[X_{n}=0]} \rightarrow_p 0\)</span>である。 すなわち、<span class="math inline">\(I_{[X_{n}=0]} \rightarrow_d 0\)</span>であることも言えて、ゆえに、(2)式の第2項は、スラツキーの定理より、0に分布収束する。</p>
<p>同様に、(2)式の第1項の一部である<span class="math inline">\(I\left(X_{n}\geq 1\right)\)</span>を確率収束の観点で考えてみる。 <span class="math inline">\(P\left( I_{[X_{n}\geq 1]} &gt;\varepsilon\right)\)</span> とすると、定義関数の性質と<span class="math inline">\(\varepsilon &gt;0\)</span>より、 <span class="math display">\[P\left( I_{[X_{n}\geq 1]} &gt;\varepsilon\right)=P\left(X_{n}\geq 1\right) = 1 - P\left(X_{n}=0 \right) = 1 - (1-p)^{n} \xrightarrow[n\rightarrow \infty]{} 1\]</span> よって、<span class="math inline">\(P\left( | I_{[X_{n}\geq 1]} - 1| &gt;\varepsilon\right) \xrightarrow[n\rightarrow \infty]{} 0\)</span>が成り立つから、<span class="math inline">\(I_{[X_{n}\geq 1]} \rightarrow_p 1\)</span>である。 すなわち、<span class="math inline">\(I_{[X_{n}\geq 1]} \rightarrow_d 1\)</span>であることも言えて、ゆえに、(2)式の第1項は、スラツキーの定理を考慮すれば、あとは<span class="math inline">\(\sqrt{n}\left(\log \frac{X_{n}}{n}-\log p\right)\)</span>のみについて考えれば良い。</p>
<p>ここで、<span class="math inline">\(\log \frac{X_{n}}{n}\)</span>の<span class="math inline">\(\frac{X_{n}}{n}=p\)</span>の周りでの1次までのテイラー展開を考えると、 <span class="math display">\[\log \frac{X_{n}}{n} = \log p + \frac{1}{p^*} \times \left( \frac{X_{n}}{n} - p \right)\]</span></p>
<p><span class="math display">\[\Leftrightarrow \log \frac{X_{n}}{n} - \log p = \frac{1}{p^*} \left( \frac{X_{n}}{n} - p \right)\]</span></p>
<p>ただし、<span class="math inline">\(p^*\)</span> は <span class="math inline">\(|p^* − p| &lt; |\frac{X_n}{n} − p|\)</span>なる点であり，<span class="math inline">\(\frac{X_n}{n} \rightarrow_p p\)</span> より, <span class="math inline">\(p^* \rightarrow_p p\)</span> となる。</p>
<p>よって、スラツキーの定理より、 <span class="math display">\[\sqrt{n}\left(\log \frac{X_{n}}{n}-\log p\right) \rightarrow_d \sqrt{n} \times \frac{1}{p} \left( \frac{X_{n}}{n}- p\right)\]</span></p>
<p>ここで、<span class="math inline">\(\frac{X_{n}}{n}\)</span>の分布について考えると、これは、<span class="math inline">\(X_n \sim Bin(n,p)\)</span>の標本平均の分布である。 よって、中心極限定理より、<span class="math inline">\(\frac{X_{n}}{n}\)</span>の平均が<span class="math inline">\(p\)</span>, 分散が<span class="math inline">\(\frac{p(1-p)}{n}\)</span>であることに注意すると、</p>
<p><span class="math display">\[\begin{aligned}
        \sqrt{n} \times \frac{1}{p} \left\{ \frac{X_{n}}{n}- p\right\}
        &amp;\rightarrow_d  \sqrt{n} \times \frac{1}{p} \left\{ \mathcal{N}(p, \frac{p(1-p)}{n})- p\right\} \\ 
        &amp;=  \sqrt{n} \times \frac{1}{p} \times \mathcal{N}(0, \frac{p(1-p)}{n}) \\ 
        &amp;=  \sqrt{n} \times  \mathcal{N}(0, \frac{1-p}{np}) \\ 
        &amp;=  \mathcal{N}(0, \frac{1-p}{p}) \\ 
    \end{aligned}\]</span></p>
<p>ゆえに、スラツキーの定理より、(2)式の第1項が<span class="math inline">\(\mathcal{N}(0, \frac{1-p}{p})\)</span>に分布収束するので、<span class="math inline">\(\sqrt{n}(Y_n − \log{p}) \rightarrow_d \mathcal{N} (0,\frac{1−p}{p})\)</span>が示された。</p>
</body>
</html>
