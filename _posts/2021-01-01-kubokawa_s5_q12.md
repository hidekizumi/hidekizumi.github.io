---
mathjax: true
abstract: 'すごく難しかったです。2問目は結局、「デルタ法より〜」みたいな感じでもかけるかなと思ったのですが、色々複雑すぎて、ギブアップしました。'
title: |
    現代数理統計学の基礎\
    〜第5章 問12〜
---
2021年8月4日

問題文
======

問 12

[\\(X\_n \\sim Bin(n,p)\\)]{.math
.inline}として、次のように[\\(Y\_n\\)]{.math .inline}を置く。 [\\\[Y\_n
= \\begin{cases} 1 & (X\_n = 0)\\\\ \\log{ (\\frac{X\_n}{n}) } & (X\_n
\\geq 1) \\end{cases}\\\]]{.math .display}

このとき [\\(Y\_n \\rightarrow\_p \\log{p}\\)]{.math
.inline}と、[\\(\\sqrt{n}(Y\_n − \\log{p}) \\rightarrow\_d \\mathcal{N}
(0,\\frac{1−p}{p})\\)]{.math .inline}を示せ。

準備
====

確率収束
--------

確率変数の列[\\(\\{U\_n\\}\_{n=1, 2, \\cdots}\\)]{.math
.inline}が確率変数[\\(U\\)]{.math
.inline}に確率収束するとは、任意の[\\(\\varepsilon \> 0\\)]{.math
.inline}に対して、 [\\\[\\lim\_{n \\rightarrow \\infty} P(\|U\_n−U\|
\\geq \\varepsilon) = 0\\\]]{.math .display}

となることをいい、[\\(U\_n \\rightarrow\_p U\\)]{.math .inline}で表す。

分布収束
--------

確率変数の列[\\(\\{U\_n\\}\_{n=1, 2, \\cdots}\\)]{.math
.inline}が確率変数[\\(U\\)]{.math .inline}に分布収束するとは、
[\\\[\\lim\_{n \\rightarrow \\infty} P(U\_n \\leq x) = P(U \\leq x) =
F\_U(x)\\\]]{.math .display}

が、[\\(F\_U(x)\\)]{.math
.inline}の連続点で成り立つことをいい、となることをいい、[\\(U\_n
\\rightarrow\_d U\\)]{.math .inline}で表す。

確率収束と分布収束の関係
------------------------

-   [\\(U\_n \\rightarrow\_p U\\)]{.math .inline}ならば、[\\(U\_n
    \\rightarrow\_d U\\)]{.math .inline}

-   [\\(a\\)]{.math .inline}を定数とすると、[\\(U\_n \\rightarrow\_d
    a\\)]{.math .inline}ならば、[\\(U\_n \\rightarrow\_p a\\)]{.math
    .inline}

スラツキーの定理
----------------

確率変数の列[\\(\\{U\_n\\}\_{n=1, 2, \\cdots}\\)]{.math
.inline}、[\\(\\{V\_n\\}\_{n=1, 2, \\cdots}\\)]{.math
.inline}、確率変数[\\(U\\)]{.math .inline}、定数[\\(a\\)]{.math
.inline}に対して、 [\\(U\_n \\rightarrow\_d U\\)]{.math
.inline}、[\\(V\_n \\rightarrow\_p a\\)]{.math
.inline}とする。このとき、次が成り立つ。

-   [\\(U\_n + V\_n \\rightarrow\_d U+a\\)]{.math .inline}

-   [\\(U\_n \\times V\_n \\rightarrow\_d a \\times U\\)]{.math .inline}

中心極限定理
------------

[\\(X\_1, X\_2, \\cdots, i.i.d. \\sim (\\mu, \\sigma)\\)]{.math .inline}
とする。この時、次の分布収束が成り立つ。 [\\\[\\lim\_{n \\rightarrow
\\infty }P\\left( \\frac{ \\sqrt{n} (X\_{n}-\\mu)}{ \\sigma} \\leq x
\\right) = \\frac{1}{\\sqrt{2 \\pi}} \\int\_{-\\infty}\^{x} e\^{-x\^{2}
/ 2} d x\\\]]{.math .display}

回答
====

まず、[\\(Y\_n \\rightarrow\_p \\log{p}\\)]{.math
.inline}、すなわち、十分小さい[\\(\\varepsilon \> 0\\)]{.math
.inline}に対して，[\\(n → \\infty\\)]{.math
.inline}のとき[\\(P(\|Y\_n−\\log{p}\| \> \\varepsilon) → 0\\)]{.math
.inline}が成り立つことを示す。 最初に、[\\(Y\_n\\)]{.math
.inline}の場合分けに基づき、 [\\\[P(\|Y\_n−\\log{p}\| \> \\varepsilon) =
P(\|\\log{\\frac{X\_n}{n}}−\\log{p}\| \> \\varepsilon,X\_n \\geq
1)+P(\|1−\\log{p}\| \> \\varepsilon,X\_n = 0) \\tag{1}\\\]]{.math
.display}と分割できる。

(1)式の第2項について、二項分布のパラメータ[\\(p\\)]{.math
.inline}は対数の真数条件などから、本問では[\\(0 \< p \\leq 1\\)]{.math
.inline}であると考えられるため、 [\\(-\\infty \< \\log{p} \\leq
0\\)]{.math .inline}であり、さらに[\\(\\varepsilon\\)]{.math
.inline}は十分小さいから、常に、 [\\(\|1−\\log{p}\| \> 1 \> \\varepsilon
\> 0\\)]{.math .inline}と言える。
よって、(1)式の第2項は、[\\(0\\leq1-p\<1\\)]{.math .inline}より、
[\\\[P(\|1−\\log{p}\| \> \\varepsilon,X\_n = 0) = P(X\_n = 0) =
\\binom{n}{0} p\^0 (1−p)\^{n-0} = (1-p)\^n \\xrightarrow\[n\\rightarrow
\\infty\]{} 0\\\]]{.math .display}となる。

(1)式の第1項については、まず、[\\(\\left\|\\log \\frac{X\_{n}}{n}-\\log
p\\right\| \> \\varepsilon\\)]{.math
.inline}の反対の区間である（言い方が変ですみません）、[\\(\\left\|\\log
\\frac{X\_{n}}{n}-\\log p\\right\| \\leq \\varepsilon\\)]{.math
.inline}について考える。

[\\\[\\begin{aligned} \\left\|\\log \\frac{X\_{n}}{n}-\\log p\\right\|
\\leq \\varepsilon &\\Longleftrightarrow \\left\|\\log
\\frac{X\_{n}}{np}\\right\| \\leq \\varepsilon \\\\
&\\Longleftrightarrow -\\varepsilon \\leq \\log \\frac{X\_{n}}{n p}
\\leq \\varepsilon \\\\ &\\Longleftrightarrow e\^{-\\varepsilon} \\leq
\\frac{X\_{n}}{n p} \\leq e\^{\\varepsilon} \\\\ &\\Longleftrightarrow
pe\^{-\\varepsilon} \\leq \\frac{X\_{n}}{n} \\leq pe\^{\\varepsilon}
\\\\ &\\Longleftrightarrow pe\^{-\\varepsilon} - p \\leq
\\frac{X\_{n}}{n} - p \\leq pe\^{\\varepsilon} - p \\\\
&\\Longleftrightarrow -p\\left(1-e\^{-\\varepsilon}\\right) \\leq
\\frac{X\_{n}}{n}-p \\leq p\\left(e\^{\\varepsilon}-1\\right) \\\\
&\\Longleftrightarrow \\left\|\\frac{X\_{n}}{n}-p \\right\| \\leq \\min
\\left\\{p\\left(1-e\^{-\\varepsilon}\\right),
p\\left(e\^{\\varepsilon}-1\\right)\\right\\} \\end{aligned}\\\]]{.math
.display}

従って，[\\(\\delta=\\min \\left\\{p\\left(1-e\^{-\\varepsilon}\\right),
p\\left(e\^{\\varepsilon}-1\\right)\\right\\}\\)]{.math .inline}
とおくと， [\\\[\\left\|\\frac{X\_{n}}{n}-p \\right\| \\leq \\delta
\\text{が満たされれば、} \\left\|\\log \\frac{X\_{n}}{n}-\\log
p\\right\| \\leq \\varepsilon \\text{が常に成り立つ。}\\\]]{.math
.display}

この対偶をとると、 [\\\[\\left\|\\log \\frac{X\_{n}}{n}-\\log
p\\right\|\>\\varepsilon \\text{が満たされれば、}
\\left\|\\frac{X\_{n}}{n}- p\\right\| \> \\delta
\\text{が常に成り立つ。}\\\]]{.math .display}

故に、(1)式の第1項は、 [\\\[\\begin{aligned} P\\left(\\left\|\\log
\\frac{X\_{n}}{n}-\\log p\\right\|\>\\varepsilon, X\_{n} \\geq 1\\right)
&= P\\left(\\left\|\\frac{X\_{n}}{n}-p\\right\|\>\\delta, X\_{n} \\geq
1\\right) \\\\ &\\leq
P\\left(\\left\|\\frac{X\_{n}}{n}-p\\right\|\>\\delta\\right)
\\text{　　(周辺確率は同時確率以上にはなるから)} \\\\
&\\xrightarrow\[n\\rightarrow \\infty\]{} 0 \\text{　　(\$X\_n \\sim
Bin(n,p)\$のとき、大数の弱法則より\$\\frac{X\_{n}}{n}はp\$
に確率収束するから)} \\end{aligned}\\\]]{.math .display}

従って、確率は常に0以上なので、はさみうち的に(1)式の第1項も0に収束する。

以上より、(1)式の第1項も第2項も[\\(n → \\infty\\)]{.math
.inline}のときに0に収束するので、 [\\(\\lim\_{n → \\infty}
P(\|Y\_n−\\log{p}\| \> \\varepsilon) = 0\\)]{.math .inline}となり、
[\\(Y\_n \\rightarrow\_p \\log{p}\\)]{.math .inline}が成り立つ。

[\\\[\\\\\\\]]{.math .display}

次に、[\\(\\sqrt{n}(Y\_n − \\log{p}) \\rightarrow\_d \\mathcal{N}
(0,\\frac{1−p}{p})\\)]{.math .inline}が成り立つことを示す。

最初に、[\\(Y\_n\\)]{.math .inline}の場合分けに基づき分割すると、
[\\\[\\sqrt{n}\\left(Y\_{n}-\\log p\\right)=\\sqrt{n}\\left(\\log
\\frac{X\_{n}}{n}-\\log p\\right) I\_{\[X\_{n} \\geq
1\]}+\\sqrt{n}(1-\\log p) I\_{\[X\_{n}=0\]} \\tag{2}\\\]]{.math
.display}

ここで、確率収束するならば分布収束が成り立つから、(2)式の第2項の一部である[\\(I\\left(X\_{n}=0\\right)\\)]{.math
.inline}を確率収束の観点で考えてみる。 [\\(P\\left( I\_{\[X\_{n}=0\]}
\>\\varepsilon\\right)\\)]{.math .inline}
とすると、定義関数の性質と[\\(\\varepsilon \>0\\)]{.math .inline}より、
[\\\[P\\left( I\_{\[X\_{n}=0\]}
\>\\varepsilon\\right)=P\\left(X\_{n}=0\\right) = \\binom{n}{0} p\^0
(1−p)\^{n-0} = (1-p)\^n \\xrightarrow\[n\\rightarrow \\infty\]{}
0\\\]]{.math .display} よって、[\\(P\\left( \| I\_{\[X\_{n}=0\]} - 0\|
\>\\varepsilon\\right) \\xrightarrow\[n\\rightarrow \\infty\]{}
0\\)]{.math .inline}が成り立つから、[\\(I\_{\[X\_{n}=0\]}
\\rightarrow\_p 0\\)]{.math .inline}である。
すなわち、[\\(I\_{\[X\_{n}=0\]} \\rightarrow\_d 0\\)]{.math
.inline}であることも言えて、ゆえに、(2)式の第2項は、スラツキーの定理より、0に分布収束する。

同様に、(2)式の第1項の一部である[\\(I\\left(X\_{n}\\geq
1\\right)\\)]{.math .inline}を確率収束の観点で考えてみる。 [\\(P\\left(
I\_{\[X\_{n}\\geq 1\]} \>\\varepsilon\\right)\\)]{.math .inline}
とすると、定義関数の性質と[\\(\\varepsilon \>0\\)]{.math .inline}より、
[\\\[P\\left( I\_{\[X\_{n}\\geq 1\]}
\>\\varepsilon\\right)=P\\left(X\_{n}\\geq 1\\right) = 1 -
P\\left(X\_{n}=0 \\right) = 1 - (1-p)\^{n} \\xrightarrow\[n\\rightarrow
\\infty\]{} 1\\\]]{.math .display} よって、[\\(P\\left( \|
I\_{\[X\_{n}\\geq 1\]} - 1\| \>\\varepsilon\\right)
\\xrightarrow\[n\\rightarrow \\infty\]{} 0\\)]{.math
.inline}が成り立つから、[\\(I\_{\[X\_{n}\\geq 1\]} \\rightarrow\_p
1\\)]{.math .inline}である。 すなわち、[\\(I\_{\[X\_{n}\\geq 1\]}
\\rightarrow\_d 1\\)]{.math
.inline}であることも言えて、ゆえに、(2)式の第1項は、スラツキーの定理を考慮すれば、あとは[\\(\\sqrt{n}\\left(\\log
\\frac{X\_{n}}{n}-\\log p\\right)\\)]{.math
.inline}のみについて考えれば良い。

ここで、[\\(\\log \\frac{X\_{n}}{n}\\)]{.math
.inline}の[\\(\\frac{X\_{n}}{n}=p\\)]{.math
.inline}の周りでの1次までのテイラー展開を考えると、 [\\\[\\log
\\frac{X\_{n}}{n} = \\log p + \\frac{1}{p\^\*} \\times \\left(
\\frac{X\_{n}}{n} - p \\right)\\\]]{.math .display}

[\\\[\\Leftrightarrow \\log \\frac{X\_{n}}{n} - \\log p =
\\frac{1}{p\^\*} \\left( \\frac{X\_{n}}{n} - p \\right)\\\]]{.math
.display}

ただし、[\\(p\^\*\\)]{.math .inline} は [\\(\|p\^\* − p\| \<
\|\\frac{X\_n}{n} − p\|\\)]{.math
.inline}なる点であり，[\\(\\frac{X\_n}{n} \\rightarrow\_p p\\)]{.math
.inline} より, [\\(p\^\* \\rightarrow\_p p\\)]{.math .inline} となる。

よって、スラツキーの定理より、 [\\\[\\sqrt{n}\\left(\\log
\\frac{X\_{n}}{n}-\\log p\\right) \\rightarrow\_d \\sqrt{n} \\times
\\frac{1}{p} \\left( \\frac{X\_{n}}{n}- p\\right)\\\]]{.math .display}

ここで、[\\(\\frac{X\_{n}}{n}\\)]{.math
.inline}の分布について考えると、これは、[\\(X\_n \\sim
Bin(n,p)\\)]{.math .inline}の標本平均の分布である。
よって、中心極限定理より、[\\(\\frac{X\_{n}}{n}\\)]{.math
.inline}の平均が[\\(p\\)]{.math .inline},
分散が[\\(\\frac{p(1-p)}{n}\\)]{.math .inline}であることに注意すると、

[\\\[\\begin{aligned} \\sqrt{n} \\times \\frac{1}{p} \\left\\{
\\frac{X\_{n}}{n}- p\\right\\} &\\rightarrow\_d \\sqrt{n} \\times
\\frac{1}{p} \\left\\{ \\mathcal{N}(p, \\frac{p(1-p)}{n})- p\\right\\}
\\\\ &= \\sqrt{n} \\times \\frac{1}{p} \\times \\mathcal{N}(0,
\\frac{p(1-p)}{n}) \\\\ &= \\sqrt{n} \\times \\mathcal{N}(0,
\\frac{1-p}{np}) \\\\ &= \\mathcal{N}(0, \\frac{1-p}{p}) \\\\
\\end{aligned}\\\]]{.math .display}

ゆえに、スラツキーの定理より、(2)式の第1項が[\\(\\mathcal{N}(0,
\\frac{1-p}{p})\\)]{.math .inline}に分布収束するので、[\\(\\sqrt{n}(Y\_n
− \\log{p}) \\rightarrow\_d \\mathcal{N} (0,\\frac{1−p}{p})\\)]{.math
.inline}が示された。
